ここまでの過程ですでに README.md が作成されているかもしれませんが、もし作成されていなければ依頼しておきましょう。

```
@csv_import, @bill_generator の readme.mdを作成して
```

readme.md とはマークダウンで書かれたプロジェクトの説明書です。どのようにプログラムを実行すればいいか書かれています。以下の内容で作成されました (macOS 環境)。これを見ればセットアップと実行方法が分かります。

~~~markdown
# 請求書自動生成システム

このプロジェクトは、Excelファイルから売上データを読み込み、取引先ごとの請求書を自動生成するPythonアプリケーションです。

## 主な機能

### 1. 請求書自動生成 (`bill_generator.py`)
- GUI操作で指定年月の請求書を一括生成
- 取引先ごとに個別のPDFファイルを出力
- 売上データの自動集計と明細行の動的調整

### 2. CSV売上データ取込 (`csv_import.py`)
- CSV形式の売上データをExcelファイルに自動取込
- 重複データの自動スキップ機能
- 処理済みCSVファイルの自動整理

## プロジェクト構成

```
cursor_excel_py/
├── bill_generator.py       # 請求書生成メインプログラム
├── csv_import.py          # CSV売上データ取込プログラム
├── requirements.txt       # 必要パッケージ一覧
├── 売上.xlsx             # 売上データファイル（売上シート・取引先シート）
├── 請求書.xlsx           # 請求書テンプレートファイル
├── csv/                  # CSV取込用フォルダ
│   └── 読取済/           # 処理済みCSVファイル保存先
└── PDF/                  # 生成されたPDF請求書保存先
```

## 環境要件

- Python 3.8以上
- Microsoft Excel（xlwingsによる操作のため）

## セットアップ

### 1. 仮想環境の作成と有効化
```bash
# 仮想環境の有効化
source .venv/bin/activate
```

### 2. 必要パッケージのインストール
```bash
pip install -r requirements.txt
```

## 使用方法

### 1. CSV売上データの取**込**

```bash
python csv_import.py
```

**機能詳細:**
- `csv/`フォルダ内のCSVファイルを`売上.xlsx`の売上シートに取込
- 重複行は自動的にスキップ
- 処理済みCSVは`csv/読取済/`フォルダに自動移動
- Shift-JIS、UTF-8エンコーディングに対応

### 2. 請求書の生成

```bash
python bill_generator.py
```

**操作手順:**
1. GUIが起動します
2. 対象年月を選択
3. 「請求書生成実行」ボタンをクリック
4. `PDF/`フォルダに請求書が生成されます

**機能詳細:**
- 指定年月の売上データを自動抽出
- 取引先ごとに売上明細を集計
- 明細行数に応じてテンプレートを動的調整
- 消費税の自動計算
- PDF形式での一括出力

## 必要ファイル

### 売上.xlsx
以下のシートが必要です：
- **売上シート**: 売上日、得意先CD、商品名、売上数、単価などの列
- **取引先シート**: 得意先CD、得意先名、郵便番号、住所などの列

### 請求書.xlsx
- **請求書(原紙)シート**: 請求書のテンプレート

## 出力ファイル

### PDFファイル
- ファイル名形式: `{得意先名}_{YYMM}.pdf`
- 保存先: `PDF/`フォルダ

### ログファイル
- `bill.log`: 請求書生成処理のログ

## 注意事項

- Excelファイルの編集中は請求書生成を実行しないでください
- CSV取込前に`売上.xlsx`がバックアップされていることを確認してください
- 大量データ処理時はメモリ使用量にご注意ください

## トラブルシューティング

### よくあるエラー

1. **「売上.xlsx が見つかりません」**
   - ワークスペース直下に`売上.xlsx`があることを確認

2. **「請求書.xlsx が見つかりません」**
   - ワークスペース直下に`請求書.xlsx`があることを確認

3. **「未登録取引先CD」**
   - 取引先シートに該当する得意先CDが登録されているか確認

4. **xlwingsエラー**
   - Microsoft Excelがインストールされているか確認
   - Excelが起動中の場合は一度終了してから実行

## ライセンス

このプロジェクトは内部使用目的で開発されています。

~~~
